import{f as e,a as l,b as a}from"../app.b3d297f1.js";import{d as r,aq as o,a1 as t,i as n,R as i,b as u,w as d,l as s,ak as p,B as v,o as c,y as m,av as y,L as f,z as E,c as b,t as h,E as g,r as k,ax as x,aE as w,k as Y,W as j}from"./framework.6d1cc099.js";import"./theme.a1c3de89.js";const A=["ElInput","ElInputNumber","ElRadioGroup","ElCheckboxGroup","ElSelect","ElCascader","ElSwitch","ElSlider","ElTimeSelect","ElTimePicker","ElDatePicker","ElRate","ElColorPicker","ElTransfer"],T="HH:mm:ss",S="YYYY-MM-DD",$={date:S,dates:S,week:"gggg[w]ww",year:"YYYY",month:"YYYY-MM",datetime:`${S} ${T}`,monthrange:"YYYY-MM",daterange:S,datetimerange:`${S} ${T}`},F=e=>"ElForm"===e.type.name?e:F(e.parent),P=e=>{if(!e)return;let l;for(let a=0;a<e.length;a++){if(l=e[a],"object"==typeof l.type&&A.includes(l.type.name))return l;if(l=P(l.children),l)return l}return l},R=r({name:"ReadonlyFormItem",__name:"index",props:{value:{},readonly:{type:Boolean,default:void 0},emptyText:{},separator:{},rangeSeparator:{},dateFormat:{}},setup(r){const A=r,S=Y(),R=o(),C=t(),M=n((()=>({...R,labelWidth:R.label?R.labelWidth||_.props.labelWidth:"auto",style:{...R.style,marginBottom:I.value&&"0"}}))),B=i(e);console.log(B);const D=n((()=>{const{default:e,...l}=C;return l})),_=F(S),G=n((()=>void 0!==A.readonly?A.readonly:_.proxy.$attrs.readonly)),I=n((()=>{var e;return["ElTableRow","ElTableBody"].includes(null==(e=null==S?void 0:S.parent)?void 0:e.type.name)})),W=u(_.proxy.model),H=u(""),q=n((()=>(null==S?void 0:S.appContext.config.globalProperties.$ReadonlyFormItem)||{}));console.log(q);const z=n((()=>I.value?{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",display:"inline-block",width:"100%",verticalAlign:"bottom"}:{wordBreak:"break-all"})),L=e=>null==e?void 0:e.type.name,N=e=>{var l;return null==(l=null==e?void 0:e.children.default())?void 0:l[0]},O=e=>(null==e?void 0:e.props.type)??"date",J=e=>{var l;const a={ElTimePicker:T,ElDatePicker:$[O(e)]};return A.dateFormat||q.value.dateFormat||(null==(l=null==e?void 0:e.props)?void 0:l.format)||a[L(e)]},K=e=>{var l,a;return null==(a=null==(l=N(e))?void 0:l.children)?void 0:a.map((e=>({label:N(e).children,value:e.props.label})))},Q=()=>A.separator||q.value.separator||",",U=()=>A.rangeSeparator||q.value.rangeSeparator||"~",V=()=>{var e,l,r,o,t,n,i,u,d,s,p;if(A.value)return A.value;const v=(()=>{var e,l;return null==(l=null==(e=R.prop)?void 0:e.split("."))?void 0:l.reduce(((e,l)=>null==e?void 0:e[l]),W.value)})(),c=P(C.default());switch(L(c)){case"ElSelect":{const a=null==(e=N(c).children)?void 0:e.map((e=>e.props));return Array.isArray(v)?null==(r=null==(l=null==a?void 0:a.filter((e=>v.includes(e.value))))?void 0:l.map((e=>e.label)))?void 0:r.join(Q()):null==(o=null==a?void 0:a.find((e=>e.value===v)))?void 0:o.label}case"ElRadioGroup":return null==(n=null==(t=K(c))?void 0:t.find((e=>e.value===v)))?void 0:n.label;case"ElCheckboxGroup":return null==(d=null==(u=null==(i=K(c))?void 0:i.filter((e=>v.includes(e.value))))?void 0:u.map((e=>e.label)))?void 0:d.join(Q());case"ElCascader":{const{options:e,separator:l="/",props:{label:a="label",value:r="value",children:o="children"}={}}=null==c?void 0:c.props,t=(e,l)=>(e.push(l),l[o]&&l[o].length&&l[o].reduce(t,e),e),n=l=>{var o;return null==(o=null==e?void 0:e.reduce(t,[]).find((e=>e[r]===l)))?void 0:o[a]};return m=v,Array.isArray(m)&&m.every((e=>Array.isArray(e)))?null==(s=v.map((e=>{var a;return null==(a=e.map(n))?void 0:a.join(l)})))?void 0:s.join(Q()):v.map(n).join(l)}case"ElTransfer":{const{data:e,props:{key:l="key",label:a="label"}={}}=null==c?void 0:c.props;return null==(p=v.map((r=>{var o;return null==(o=e.find((e=>e[l]===r)))?void 0:o[a]})))?void 0:p.join(Q())}case"ElTimePicker":return Array.isArray(v)&&v.length?v.map((e=>a(e).format(J(c)))).join(U()):v;case"ElDatePicker":{if(!v)return v;const e=J(c),l=["monthrange","daterange","datetimerange"].includes(O(c))?U():Q();return Array.isArray(v)?v.map((l=>a(l).format(e))).join(l):a(v).format(e)}case"ElSwitch":{const{activeText:e,inactiveText:l}=null==c?void 0:c.props;return v?e||(null==c?void 0:c.props["active-text"])||"开":l||(null==c?void 0:c.props["inactive-text"])||"关"}case"ElSlider":return Array.isArray(v)?v.join(U()):v;default:return v}var m},X=()=>{try{const e=V();H.value="number"==typeof e?e:e||A.emptyText||q.value.emptyText||"-",console.log(e)}catch(e){}},Z=e=>{j((()=>{var a,r;const o=null==(r=null==(a=null==S?void 0:S.proxy)?void 0:a.$el)?void 0:r.__vnode.ctx.provides[l];e?null==B||B.removeField(o):null==B||B.addField(o)}))};return d((()=>_.proxy.model),(e=>{W.value=e,X()}),{deep:!0,immediate:!0}),d((()=>R),X,{deep:!0}),d(G,Z),s((()=>{G.value&&Z(!0)})),p((()=>{var e,l;G.value&&(null==(l=null==(e=null==S?void 0:S.vnode)?void 0:e.props)||delete l.prop)})),(e,l)=>{const a=v("el-form-item");return c(),m(a,x(w(M.value)),y({default:E((()=>[G.value?(c(),b("span",{key:0,style:g(z.value)},h(H.value),5)):k(e.$slots,"default",{key:1})])),_:2},[f(D.value,((l,a)=>({name:a,fn:E((()=>[k(e.$slots,a)]))})))]),1040)}}});export{R as default};
